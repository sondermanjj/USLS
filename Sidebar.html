<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <script src="https://apis.google.com/js/api.js?onload=onApiLoad"></script>
    <?!= include('Stylesheet'); ?>
    <!-- The CSS package above applies Google styling to buttons and other elements. -->
  </head>
    <body>
    
      <!--Navbar; On menu Item click, hide or display appropriate data and buttons -->
      <div id="tabs">
      <ul>
        <li class="active" id="cleanTab" onclick="showCleanupPage(); hideStatisticsPage(); hideSearchPage(); changeID('clean');">Clean-Up</li>
        <li class="inactive" id="statsTab" onclick="showStatisticsPage(); hideCleanupPage(); hideSearchPage(); changeID('stats');">Statistics</li>
        <li class="inactive" id="searchTab" onclick="showSearchPage(); hideCleanupPage(); hideStatisticsPage(); changeID('search');">Search/Sort</li>
     </ul>
     </div>
     
     <div id="cleanPage">
       <div id="reqSheets">Before initializing data, please make sure that you have the following sheets:
         <ul>
           <li>Raw Data</li>
           <li>Faculty Choices</li>
           <li>DoD List</li>
         </ul>
       </div>
       <button id="cleanButton" class="action" onclick="google.script.run.initialization();">Initialize</button>
       <button id="exportButton" class="action" onclick="google.script.run.exportToWebsitePrompt();">Export</button>
       <button id="setColumnsButton" class="action" onclick="google.script.run.setColumnProperties();">Reset Columns</button>
       <button class="action" onclick="google.script.run.showScheduleChangesPrompt();">New Schedule Change</button>
     </div>
     
     <div id="statsPage">
       <button id="scanButton" class="action" onclick="scanData();">Check Statistics</button>
       <button id="changeButton" class="action" onclick="google.script.run.parseStudentChanges()">Auto-Reassign</button>
       <div id="changes"></div>
       <div id="stats"></div>
     </div>
     
     <div id="searchPage">
       <h2>Search</h2>
       <div>Must do an initial scan on data before searching. Use the search to hide values not matching your search.</div>
       <div>Searches can be stacked on top of one another. "Show All" will show all rows again.</div>
       <select onload="listHeaders" id="dropdownfilter">
        
         <script>
            google.script.run.withSuccessHandler(listHeaders).getHeaderColumnNames();
           function listHeaders(list) {  
             var html = document.getElementById('dropdownfilter');
             var headers = JSON.parse(list);
             var newhtml = "<option value=\"All\">All</option>";
             for(var i = 0; i < headers.length; i++) {
               newhtml += "<option value=\"" + headers[i] + "\">" + headers[i] + "</option>";
             }
             html.innerHTML = newhtml;
           }
           </script>
         
       </select>
       <input type="text" id="filter" onkeypress="mySearch(event)" placeholder="Search for names..">
       <table id="searchButtons">
         <tr>
           <td><button id="searchButton" class="action" onclick="search()">Search</button></td>
           <td><button class="action" onclick="google.script.run.showDialog('show');">Show All</button></td>
         </tr>
       </table>
       <h2>Sort</h2>
       <table id="sortButtons">
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('l');">l</button></td>
           <td colspan="1">Sort by Lunch</td>
         </tr>
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('n');">n</button></td>
           <td colspan="1">Sort by Lunch then Table Number</td>
         </tr>
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('j');">j</button></td>
           <td colspan="1">Sort by Table</td>
         </tr>
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('k');">k</button></td>
           <td colspan="1">Sort by Course</td>
         </tr>
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('t')">t</button></td>
           <td colspan="1">Sort by Individual by Lunch Day</td>
         </tr>
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('g')">g</button></td>
           <td colspan="1">Sort by Individual by Block</td>
         </tr>
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('p')">p</button></td>
           <td colspan="1">Sort by House</td>
         </tr>
       </table>
       <table id="customSort">
          <tr>
           <td colspan="2">Enter the order in which you would like to filter the sort using column names, separated by a comma.</td>
         </tr>
         <tr>
           <td><input type="text" id="customSearch" placeholder="Search filters"></td>
           <td><button class="action" onclick="customSort()">Sort</button></td>
         </tr>
       </table>
       
     </div>
      <?!= include('Javascript'); ?>
    </body>
</html>