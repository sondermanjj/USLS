<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <script src="https://apis.google.com/js/api.js?onload=onApiLoad"></script>
    <?!= include('Stylesheet'); ?>
    <!-- The CSS package above applies Google styling to buttons and other elements. -->
    
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <?!= include('Stylesheet.html'); ?>
    
    <script>
    //JSHint Verified 5/14/17
    
    
    /**
    * @desc - displays current day settings to the sidebar
    * @author - clemensam
    */
    function displayLetterDays(){
      var days = google.script.run.getLetterDays();
      document.getElementById('currentDays').innerHTML = days;  
    }
    
    /**
    * @desc - pulls letter day information from the text boxes in the settings page and saves them to the document properties
    * @author - clemensam
    */
    function saveLetterDays(){
      var dayBoxes = document.getElementsByClassName('daySettingsBox');
      var numBoxes = document.getElementsByClassName('dayNumberBox');
      var daysList = [];
      var schoolDays = {};
      for (var i = 0; i < dayBoxes.length; i++) {
        if(dayBoxes[i].value.trim() !== "" && numBoxes[i].value.trim() !== ""){
          daysList.push(dayBoxes[i].value);
          schoolDays[parseInt(numBoxes[i].value)] = dayBoxes[i].value;
          schoolDays[dayBoxes[i].value + numBoxes[i].value] = dayBoxes[i].value;
        }
      }
      google.script.run.setLetterDays(daysList); 
      google.script.run.setSchoolDays(schoolDays);
    }
    
    function consoleDisplay(toPrint){
      var printDiv = document.getElementById('testingDiv');
      printDiv.innerHTML = toPrint;
    }
    
    /*
    * @desc - pulls lunch time information from the text boxes in the settings page and saves them to the document properties
    * @author - clemensam
    */
    function saveLunchTimes(){
      var lunchTimeBoxes = document.getElementsByName("timeBox");
      var numTableBoxes = document.getElementsByName('tableBox');
      var numStudentsBoxes = document.getElementsByName('studentsBox');
      var priorityBoxes = document.getElementsByName('priorityBox');
      var fontBoxes = document.getElementsByName('fontBox');
      var backgroundBoxes = document.getElementsByName('backgroundBox');
      var assignedLunchList = [];
      var nonAssignedLunchList = [];
      var lunchtimes = [];
      var timeObj;
      
      for(var j = 1; j < lunchTimeBoxes.length+1; j++) {
        var elem = document.getElementById('time' + j.toString());
        console.log("elem: " + elem.id);
        if(elem.style.display !== 'none'){
          console.log(elem.style.display);
          var dropdown = document.getElementsByName('lunch' + j.toString() + 'Assigning')[0];
          var priority = parseInt(priorityBoxes[j-1].value);
          var font = fontBoxes[j-1].value;
          var background = backgroundBoxes[j-1].value;
          var time = lunchTimeBoxes[j-1].value;
          if(dropdown.options[dropdown.selectedIndex].value === 'table'){
            timeObj = {"numTables": parseInt(numTableBoxes[j-1].value), "numStudents": parseInt(numStudentsBoxes[j-1].value), "by": "table",
                        "priority": priority, "time": time};
            assignedLunchList.push(timeObj);
          }
          else if(dropdown.options[dropdown.selectedIndex].value === 'house'){
            timeObj = {"numTables": parseInt(numTableBoxes[j-1].value), "numStudents": parseInt(numStudentsBoxes[j-1].value), "by": "house",
                        "priority": priority, "time": time};
            nonAssignedLunchList.push(timeObj);
          }
          else if(dropdown.options[dropdown.selectedIndex].value === 'not'){
            timeObj = {"numTables": parseInt(numTableBoxes[j-1].value), "numStudents": parseInt(numStudentsBoxes[j-1].value), "by": "none",
                        "priority": priority, "time": time};
            nonAssignedLunchList.push(timeObj);
          }
          lunchtimes.push({"name": time, "priority": priority, "font": font, "background": background}); 
        }
      }
      setLunchProperties(nonAssignedLunchList, assignedLunchList, lunchtimes);
    }
    
    /**
    * @desc - sets the lunch time properties to the correct values
    * @param - nonAssigned - array of json objects of nonassigned lunch times
    *          assigned - array of json objects of assigned lunch times
    *          all - array of all lunch times
    */
    function setLunchProperties(nonAssigned, assigned, all){
      google.script.run.setNonAssignedLunches(nonAssigned);
      google.script.run.setAssignedLunches(assigned);
      google.script.run.setLunchTimes(all);
    }
    
    /**
    * @desc - saves faculty choices and final student data sheet names from settings tab into properties
    * @author - clemensam
    */
    function saveSheetNames(){
      var teacherChoicesSheet = document.getElementById('facultyChoicesSheetName').value;
      var studentDataSheet = document.getElementById('studentDataSheetName').value;
      var dodSheet = document.getElementById('dodSheetName').value;
      google.script.run.withSuccessHandler(saveTeacherSheet).sheetExists(teacherChoicesSheet);
      google.script.run.withSuccessHandler(saveStudentSheet).sheetExists(studentDataSheet);
      google.script.run.withSuccessHandler(saveDODSheet).sheetExists(dodSheet);
    }
    
    /**
    * @desc - saves faculty choices sheet name property
    * @author - clemensam
    */
    function saveTeacherSheet(valid){
      var teacherChoicesSheet = document.getElementById('facultyChoicesSheetName').value;
      if(valid){
        google.script.run.setTeacherChoicesSheet(teacherChoicesSheet);
      }
      else {
        google.script.run.showMessage("Whoops! The Faculty Choices Sheet name that you entered does not exist. This setting could not be saved.");
      }
    }
    
    /**
    * @desc - saves final student data sheet name property
    * @author - clemensam
    */
    function saveStudentSheet(valid){
      var studentDataSheet = document.getElementById('studentDataSheetName').value;
      if(valid){
        google.script.run.setStudentSheet(studentDataSheet);
      }
      else {
        google.script.run.showMessage("Whoops! The Final Student Data Sheet name that you entered does not exist. This setting could not be saved.");
      } 
    }
    
    /**
    * @desc - saves dod sheet name property
    * @author - dicksontc
    */
    function saveDODSheet(valid){
      var dodDataSheet = document.getElementById('dodSheetName').value;
      if(valid){
        google.script.run.setDODSheet(dodDataSheet);
      }
      else {
        google.script.run.showMessage("Whoops! The DOD Sheet name that you entered does not exist. This setting could not be saved.");
      } 
    }
    
    function saveHouses(){
      var houseNames = document.getElementsByClassName("houseNameSettingsBox");
      var houseFonts = document.getElementsByClassName("houseFontSettingsBox");
      var houseBGs = document.getElementsByClassName("houseBGSettingsBox");
      
      var housesList = [];
      
      for(var j = 1; j < houseNames.length+1; j++) {
        var name = document.getElementById('house' + j.toString() + "name").value;
        var font = document.getElementById('house' + j.toString() + "font").value;
        var bg = document.getElementById('house' + j.toString() + "bg").value;
        housesList.push({"name": name, "font": font, "background": bg})
      }
      setHouses(housesList);
    }
    
    
    function showMenus(){
      scanBoth();
      google.script.run.withSuccessHandler(displayDropdown).getDropdownHTML();
    }
    /**
      * @desc - Scans the data for statistics
      * @author - hendersonam
      */
    function scanData() {
      google.script.run.withSuccessHandler(scanBoth).showDialog('sc');
      google.script.run.withSuccessHandler(displayDropdown).getDropdownList();  
    }
    
    /**
    * @desc - Puts the scanStats and scanChanges method into one method so that it can be called when opening the loading dialog
    */
    function scanBoth() {
      scanStats();
      scanChanges();
    }
    
    /**
      * @desc - Scans the statistics
      * @author - hendersonam
      */
    function scanStats() {
      google.script.run.withSuccessHandler(displayStats).getStatistics();
    }
    
    /**
      * @desc - Scans the schedule changes
      * @author - hendersonam
      */
    function scanChanges() {
      google.script.run.withSuccessHandler(displayScheduleChanges).getScheduleChanges();
    }
    
    /**
      * @desc - Dissplays the dropdown menu to list the columns that can be used for filtering
      * @author - hendersonam
      */
    function displayDropdown(list) {
    }
    
    /**
      * @desc - Displays Lunch Statistics
      * @author - hendersonam
      */
    function displayStats(statistics) {
      var html = document.getElementById('stats');
      html.innerHTML = statistics;
      
    } 
    
    /**
      * @desc - Displays Schedule Changes
      * @author - hendersonam
      */
    function displayScheduleChanges(changes) {
      var html = document.getElementById('changes');
      html.innerHTML = changes;
      
    }
    
    /**
     * @desc - If the enter key or search button is pressed, hideValues that do not contain the string in the text box
     * @param - event - the button that is pressed
     * @author - hendersonam
     */
    function mySearch(e) {
      var key= e.keyCode || e.which;
      if (key==13){
        var filter = document.getElementById('filter').value.toLowerCase();
        var column = document.getElementById('dropdownfilter').value;
        google.script.run.showDialog('search, ' + filter + ', ' + column);
      }
    }
    
    /*
    * @desc - same as above method, but used on press instead up enter key press
    */
    function search(){
      var filter = document.getElementById('filter').value.toLowerCase();
      var column = document.getElementById('dropdownfilter').value;
      google.script.run.showDialog('search, ' + filter + ', ' + column);
    }
    
    /*
    * @desc - gets sort information from text box and calls method to create custom sort
    * @author - clemensam
    */
    function customSort(){
      var sortFilters = document.getElementById('customSearch').value;
      google.script.run.showDialog('sort, ' + sortFilters);
    }
    /**
    * @desc - Shows the contents relating to sheet clean up
    * @author - clemensam
    */
    function showCleanupPage(){
      var x = document.getElementById('cleanPage');
      x.style.display = 'block';
    }
    
    /**
    * @desc - Shows the contents relating to the sheet's statistics
    * @author - clemensam
    */
    function showStatisticsPage(){
      var x = document.getElementById('statsPage');
      x.style.display = 'block';
    }
    
    /**
    * @desc - Shows the contents relating to the search function for the sheet
    * @author - clemensam
    */
    function showSearchPage(){
      var x = document.getElementById('searchPage');
      x.style.display = 'block';
    }
    
    /**
    * @desc - Shows the contents of the settings page
    * @author - clemensam
    */
    function showSettingsPage(){
      var x = document.getElementById('settingsPage');
      x.style.display = 'block';
    }
    
    /**
    * @desc - Hides the clean page contents
    * @author - clemensam
    */
    function hideCleanupPage(){
      var x = document.getElementById('cleanPage');
      x.style.display = 'none';
    }
    
    /**
    * @desc - Hides the statistics page contents
    * @author - clemensam
    */
    function hideStatisticsPage(){
      var x = document.getElementById('statsPage');
      x.style.display = 'none';
    }
    
    /**
    * @desc - Hides the search page contents
    * @author - clemensam
    */
    function hideSearchPage(){
      var x = document.getElementById('searchPage');
      x.style.display = 'none';
    }
    
    /**
    * @desc - Hides the settings page contents
    * @author - clemensam
    */
    function hideSettingsPage(){
      var x = document.getElementById('settingsPage');
      x.style.display = 'none';
    }
    
    function hideTimeEntry(id){
      var x = document.getElementById(id);
      x.style.display = 'none';
    }
    
    function addTimeEntry(){
      var time1 = document.getElementById('time1');
      var time2 = document.getElementById('time2');
      var time3 = document.getElementById('time3');
      if(time1.style.display === 'none'){
        time1.style.display = 'block';
      }
      else if(time2.style.display === 'none'){
        time2.style.display = 'block';
      }
      else{
        time3.style.display = 'block';
      }
    }
    
    /**
    * @desc - Changes tab class names in order to highlight the active tab
    * @author - clemensam
    */
    function changeID(button){
      switch (button){
        case 'clean':
          document.getElementById('cleanTab').className = 'active';
          document.getElementById('statsTab').className = 'inactive';
          document.getElementById('searchTab').className = 'inactive';
          break;
        case 'stats':
          document.getElementById('cleanTab').className = 'inactive';
          document.getElementById('statsTab').className = 'active';
          document.getElementById('searchTab').className = 'inactive';
          break;
        case 'search':
          document.getElementById('cleanTab').className = 'inactive';
          document.getElementById('statsTab').className = 'inactive';
          document.getElementById('searchTab').className = 'active';
          break;
        case 'settings':
          document.getElementById('cleanTab').className = 'inactive';
          document.getElementById('statsTab').className = 'inactive';
          document.getElementById('searchTab').className = 'inactive';
      }
}
 /**
    * @desc - saves all properties entered into the settings page
    * @author - clemensam
    */
    function saveAll(){
       /*showCleanupPage(); 
       hideSettingsPage(); 
       hideStatisticsPage(); 
       hideSearchPage(); 
       changeID('clean');*/
       saveLetterDays();
       saveLunchTimes();
       saveSheetNames();
    }
    
    
    </script>
  </head>
    <body>
    
      <!--Navbar; On menu Item click, hide or display appropriate data and buttons -->
      <div id="tabs">
      <span>
      <ul>
        <li class="active" id="cleanTab" onclick="showCleanupPage(); hideSettingsPage(); hideStatisticsPage(); hideSearchPage(); changeID('clean');">Clean-Up</li>
        <li class="inactive" id="statsTab" onclick="showStatisticsPage(); hideSettingsPage(); hideCleanupPage(); hideSearchPage(); changeID('stats');">Statistics</li>
        <li class="inactive" id="searchTab" onclick="showSearchPage(); hideSettingsPage(); hideCleanupPage(); hideStatisticsPage(); changeID('search');">Search/Sort</li>
     </ul>
     </span>
     <span>
       <img id="settingsButton" onClick="showSettingsPage(); hideCleanupPage(); hideStatisticsPage(); hideSearchPage(); changeID('settings');" src="https://8f0924f2-a-62cb3a1a-s-sites.googlegroups.com/site/usmlunch/tinysettings.png?attachauth=ANoY7crc2QY618uAJn01SKJu8slTjWxOe6AEjkKSJmmv_qvMkhiOb5VVNgxLF_zwxfjzuzMYVnKLUVlijeDSTn7ev03WTqlIqKTweHtVCi1A8jjxWMGj3iXchwrGQPbqzRqOfbkJl2-bCD2NHwQk1J_9OCbTKpfUWfak4inWzdRVL-Tjoa04vfW-JGZW_Zbw0IEe8743FVS3_c0TDpKNPiUeyHtYYUHU6g%3D%3D&attredirects=0"/>
     </span>
     </div>
     
     <div id="cleanPage">

       <button id="cleanButton" class="action" onclick="google.script.run.showCleanUpPrompt();">Start</button>

       <button id="exportButton" class="share" onclick="google.script.run.exportToWebsite();">Export</button>

     </div>
     
     <div id="statsPage">
       <button id="scanButton" class="action" onclick="scanData();">Check Statistics</button>
       <button id="scheduleChangeButton" class="action" onclick="google.script.run.showScheduleChangesPrompt();">Make Schedule Change</button>
       <div id="changes"></div>
       <div id="stats"></div>
     </div>
     
     <div id="searchPage">
       <h2>Search</h2>
       <div>Must do an initial scan on data before searching. Use the search to hide values not matching you search.</div>
       <div>Searches can be stacked on top of one another. "Show All" will show all rows again.</div>
       <select onload="listHeaders" id="dropdownfilter">
        
         <script>
            google.script.run.withSuccessHandler(listHeaders).getHeaderColumnNames();
           function listHeaders(list) {  
             var html = document.getElementById('dropdownfilter');
             var headers = JSON.parse(list);
             var newhtml = "<option value=\"All\">All</option>";
             for(var i = 0; i < headers.length; i++) {
               newhtml += "<option value=\"" + headers[i] + "\">" + headers[i] + "</option>";
             }
             html.innerHTML = newhtml;
           }
           </script>
         
       </select>
       <input type="text" id="filter" onkeypress="mySearch(event)" placeholder="Search for names..">
       <table id="searchButtons">
         <tr>
           <td><button id="searchButton" class="action" onclick="search()">Search</button></td>
           <td><button class="action" onclick="google.script.run.showDialog('show');">Show All</button></td>
         </tr>
       </table>
       <h2>Sort</h2>
       <table id="sortButtons">
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('l');">l</button></td>
           <td colspan="1">Sort by Lunch</td>
         </tr>
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('n');">n</button></td>
           <td colspan="1">Sort by Lunch then Table Number</td>
         </tr>
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('j');">j</button></td>
           <td colspan="1">Sort by Table</td>
         </tr>
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('k');">k</button></td>
           <td colspan="1">Sort by Course</td>
         </tr>
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('t')">t</button></td>
           <td colspan="1">Sort by Individual by Lunch Day</td>
         </tr>
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('g')">g</button></td>
           <td colspan="1">Sort by Individual by Block</td>
         </tr>
         <tr>
           <td colspan="1"><button class="action" onclick="google.script.run.showDialog('p')">p</button></td>
           <td colspan="1">Sort by House</td>
         </tr>
       </table>
       <table id="customSort">
          <tr>
           <td colspan="2">Enter the order in which you would like to filter the sort using column names, separated by a comma.</td>
         </tr>
         <tr>
           <td><input type="text" id="customSearch" placeholder="Search filters"></td>
           <td><button class="action" onclick="customSort()">Sort</button></td>
         </tr>
       </table>
       
     </div>
      <?!= include('Javascript'); ?>
     
<div id="settingsPage">

    <h2> Settings</h2>
    
    <div id='testingDiv'></div>
    
    <div id="currentDays"></div>

    <table id="settingsTable">
        <tr>
            <th colspan=2>Letter Days in Schedule</th>
        </tr>

        <td id="fullWidth"colspan=2>
            <table class="table table-striped">
                <tr>
                    <td>
                        <div class="row">
                            <span class="rowLabel">Letter: </span>
                            <span><input class="daySettingsBox" id="day1" type="text" onkeypress="" name="a-day" value="A"/></span>
                            <span class="numLabel">Block: </span>
                            <span><input class="dayNumberBox" id="day1num" type="text" onkeypress="" name="a-day" value="3"/></span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="row">
                            <span class="rowLabel">Letter: </span>
                            <span><input class="daySettingsBox" id="day2" type="text" onkeypress="" name="b-day" value="B"/></span>
                            <span class="numLabel">Block: </span>
                            <span><input class="dayNumberBox" id="day2num" type="text" onkeypress="" name="b-day" value="7"/></span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="row">
                            <span class="rowLabel">Letter: </span>
                            <span><input class="daySettingsBox" id="day3" type="text" onkeypress="" name="c-day" value="C"/></span>
                            <span class="numLabel">Block: </span>
                            <span><input class="dayNumberBox" id="day3num" type="text" onkeypress="" name="c-day" value="4"/></span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="row">
                            <span class="rowLabel">Letter: </span>
                            <span><input class="daySettingsBox" id="day4" type="text" onkeypress="" name="d-day" value="D"/></span>
                            <span class="numLabel">Block: </span>
                            <span><input class="dayNumberBox" id="day4num" type="text" onkeypress="" name="d-day" value="8"/></span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="row">
                            <span class="rowLabel">Letter: </span>
                            <span><input class="daySettingsBox" id="day5" type="text" onkeypress="" name="e-day" value="E"/></span>
                            <span class="numLabel">Block: </span>
                            <span><input class="dayNumberBox" id="day5num" type="text" onkeypress="" name="e-day" value="1"/></span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="row">
                            <span class="rowLabel">Letter: </span>
                            <span><input class="daySettingsBox" id="day6" type="text" onkeypress="" name="f-day" value="F"/></span>
                            <span class="numLabel">Block: </span>
                            <span><input class="dayNumberBox" id="day6num" type="text" onkeypress="" name="f-day" value="5"/></span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="row">
                            <span class="rowLabel">Letter: </span>
                            <span><input class="daySettingsBox" id="day7" type="text" onkeypress="" name="g-day" value="G"/></span>
                            <span class="numLabel">Block: </span>
                            <span><input class="dayNumberBox" id="day7num" type="text" onkeypress="" name="g-day" value="2"/></span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="row">
                            <span class="rowLabel">Letter: </span>
                            <span><input class="daySettingsBox" id="day8" type="text" onkeypress="" name="h-day" value="H"/></span>
                            <span class="numLabel">Block: </span>
                            <span><input class="dayNumberBox" id="day8num" type="text" onkeypress="" name="h-day" value="6"/></span>
                        </div>
                    </td>
                </tr>
            </table>
        </td>
        <tr>
            <th colspan=2>Houses</th>
        </tr>

        <td id="fullWidth"colspan=2>
            <table class="table table-striped">
                <tr>
                    <td>
                      <div class="houseSettingsTable" id="house1">
                        <div class="row">
                            <span class="rowLabel">House Name: </span>
                            <span class="inputSpan"><input class="houseNameSettingsBox" id="house1name" type="text" onkeypress="" name="house1name" value="Academy"/></span>
                        </div>
                        <div class="row">
                            <span class="rowLabel">Font Color: </span>
                            <span class="inputSpan"><input class="houseFontSettingsBox" id="house1font" type="text" onkeypress="" name="house1font" value="#3366ff"/></span>
                        </div>
                        <div class="row">
                            <span class="rowLabel">Background Color: </span>
                            <span class="inputSpan"><input class="houseBGSettingsBox" id="house1bg" type="text" onkeypress="" name="house1bg" value="WHITE"/></span>
                        </div>
                      </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="houseSettingsTable" id="house2">
                        <div class="row">
                            <span class="rowLabel">House Name: </span>
                            <span class="inputSpan"><input class="houseNameSettingsBox" id="house2name" type="text" onkeypress="" name="house2name" value="Arrow"/></span>
                        </div>
                        <div class="row">
                            <span class="rowLabel">Font Color: </span>
                            <span class="inputSpan"><input class="houseFontSettingsBox" id="house2font" type="text" onkeypress="" name="house2font" value="#008000"/></span>
                        </div>
                        <div class="row">
                            <span class="rowLabel">Background Color: </span>
                            <span class="inputSpan"><input class="houseBGSettingsBox" id="house2bg" type="text" onkeypress="" name="house2bg" value="WHITE"/></span>
                        </div>
                      </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="houseSettingsTable" id="house3">
                        <div class="row">
                            <span class="rowLabel">House Name: </span>
                            <span class="inputSpan"><input class="houseNameSettingsBox" id="house3name" type="text" onkeypress="" name="house3name" value="Crest"/></span>
                        </div>
                        <div class="row">
                            <span class="rowLabel">Font Color: </span>
                            <span class="inputSpan"><input class="houseFontSettingsBox" id="house3font" type="text" onkeypress="" name="house3font" value="#ff0000"/></span>
                        </div>
                        <div class="row">
                            <span class="rowLabel">Background Color: </span>
                            <span class="inputSpan"><input class="houseBGSettingsBox" id="house3bg" type="text" onkeypress="" name="house3bg" value="WHITE"/></span>
                        </div>
                      </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="houseSettingsTable" id="house4">
                        <div class="row">
                            <span class="rowLabel">House Name: </span>
                            <span class="inputSpan"><input class="houseNameSettingsBox" id="house4name" type="text" onkeypress="" name="house4name" value="Ledger"/></span>
                        </div>
                        <div class="row">
                            <span class="rowLabel">Font Color: </span>
                            <span class="inputSpan"><input class="houseFontSettingsBox" id="house4font" type="text" onkeypress="" name="house4font" value="YELLOW"/></span>
                        </div>
                        <div class="row">
                            <span class="rowLabel">Background Color: </span>
                            <span class="inputSpan"><input class="houseBGSettingsBox" id="house4bg" type="text" onkeypress="" name="house4bg" value="#660066"/></span>
                        </div>
                      </div>
                    </td>
                </tr>
            </table>
        </td>
        <tr>
        <tr>
            <th colspan=2>Lunch Times</th>
        </tr>
        <tr>
            <td id="fullWidth"colspan=2>
                <table class="table table-striped">
                    <tr>
                        <td>
                            <div class="daySettingsTable" id="time1">
                                <div class="row">
                                    <span class="rowLabel">Time: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="early" type="text" onkeypress="" name="timeBox" value="early"/></span>
                                </div>
                                <div class="row">
                                    <span class="rowLabel">Number of Tables: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="earlytables" type="text" onkeypress="" name="tableBox" value="19"/></span>
                                </div>
                                <div class="row">
                                    <span class="rowLabel">Number of Students: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="earlystudents" type="text" onkeypress="" name="studentsBox" value="133"/></span>
                                </div>
                                <div class="row assigning">
                                    <span class="rowLabel">Assigning Rule </span>
                                    <span>
                                      <form>
                                        <select class ="assigning" name="lunch1Assigning">
                                          <option value="not">Not Assigned</option>
                                          <option value="table" selected>By Table</option>
                                          <option value="house">By House</option>
                                        </select>
                                    </form>
                                  </span>
                                </div>
                                <div class="row">
                                    <span class="rowLabel">Priority: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="earlypriority" type="text" onkeypress="" name="priorityBox" value="1"/></span>
                                </div>
                                <div class="fontColor">
                                    <span class="rowLabel">Font Color: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="earlyfont" type="text" onkeypress="" name="fontBox" value="BLACK"/></span>
                                </div>
                                <div class="backgroundColor">
                                    <span class="rowLabel">Background Color: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="earlybgcolor" type="text" onkeypress="" name="backgroundBox" value="YELLOW"/></span>
                                </div>
                                <button class="action add_remove_button" onclick="hideTimeEntry('time1');">Remove</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td >
                            <div class="daySettingsTable" id="time2">
                                <div class="row">
                                    <span class="rowLabel">Time: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="mid" type="text" onkeypress="" name="timeBox" value="mid"/></span>
                                </div>
                                <div class="row">
                                    <span class="rowLabel">Number of Tables: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="midtables" type="text" onkeypress="" name="tableBox" value="19"/></span>
                                </div>
                                <div class="row">
                                    <span class="rowLabel">Number of Students: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="midstudents" type="text" onkeypress="" name="studentsBox" value="133"/></span>
                                </div>
                                <div class="row assigning">
                                    <span class="rowLabel">Assigning Rule </span>
                                    <span>
                                      <form>
                                        <select class ="assigning" name="lunch2Assigning">
                                          <option value="not" selected>Not Assigned</option>
                                          <option value="table">By Table</option>
                                          <option value="house">By House</option>
                                        </select>
                                    </form>
                                  </span>
                                </div>
                                <div class="row">
                                    <span class="rowLabel">Priority: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="midpriority" type="text" onkeypress="" name="priorityBox" value="3"/></span>
                                </div>
                                <div class="fontColor">
                                    <span class="rowLabel">Font Color: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="midfont" type="text" onkeypress="" name="fontBox" value="BLACK"/></span>
                                </div>
                                <div class="backgroundColor">
                                    <span class="rowLabel">Background Color: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="midbgcolor" type="text" onkeypress="" name="backgroundBox" value="WHITE"/></span>
                                </div>
                                <button class="action add_remove_button" onclick="hideTimeEntry('time2');">Remove</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan=2>
                            <div class="daySettingsTable" id="time3">
                                <div class="row">
                                    <span class="rowLabel">Time: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="late" type="text" onkeypress="" name="timeBox" value="late"/></span>
                                </div>
                                <div class="row">
                                    <span class="rowLabel">Number of Tables: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="latetables" type="text" onkeypress="" name="tableBox" value="19"/></span>
                                </div>
                                <div class="row">
                                    <span class="rowLabel">Number of Students: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="latestudents" type="text" onkeypress="" name="studentsBox" value="133"/></span>
                                </div>
                                <div class="row assigning">
                                    <span class="rowLabel">Assigning Rule </span>
                                    <span>
                                      <form>
                                        <select class ="assigning" name="lunch3Assigning">
                                          <option value="not">Not Assigned</option>
                                          <option value="table">By Table</option>
                                          <option value="house" selected>By House</option>
                                        </select>
                                    </form>
                                  </span>
                                </div>
                                <div class="row">
                                    <span class="rowLabel">Priority: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="latepriority" type="text" onkeypress="" name="priorityBox" value="2"/></span>
                                </div>
                                <div class="fontColor">
                                    <span class="rowLabel">Font Color: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="latefont" type="text" onkeypress="" name="fontBox" value="BLACK"/></span>
                                </div>
                                <div class="backgroundColor">
                                    <span class="rowLabel">Background Color: </span>
                                    <span class="inputSpan"><input class="settingsBox" id="latebgcolor" type="text" onkeypress="" name="backgroundBox" value="#8db4e2"/></span>
                                </div>
                                <button class="action add_remove_button" onclick="hideTimeEntry('time3');">Remove</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                      <td><button class="action add_remove_button" onclick="addTimeEntry();">Add Lunch Time</button>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <th colspan=2>Sheet Names</th>
        </tr>
        <tr>
            <td id="fullWidth"colspan=2>
                <table class="table table-striped">
                    <tr>
                        <td>
                            <div class="row">
                                <span class="rowLabel">Final Student Data: </span>
                                <span class="inputSpan"><input class="settingsBox" id="studentDataSheetName" type="text" onkeypress="" name="finalDataSheetName" value=""/></span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="row">
                                <span class="rowLabel">Faculty Choices: </span>
                                <span class="inputSpan"><input class="settingsBox" id="facultyChoicesSheetName" type="text" onkeypress="" name="facultyChoicesSheetName" value=""/></span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="row">
                                <span class="rowLabel">DOD List: </span>
                                <span class="inputSpan"><input class="settingsBox" id="dodSheetName" type="text" onkeypress="" name="dodSheetName" value=""/></span>
                            </div>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <button class="action" onclick="saveAll();">Save</button>

</div>
<br/>
      
</body>
</html>